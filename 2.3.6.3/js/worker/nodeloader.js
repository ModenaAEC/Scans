var F=F||{assert:function(){}},NodeLoader={};NodeLoader.load=function(t,e){var r=t.url,n={request:t},a=new XMLHttpRequest;a.onreadystatechange=function(){if(4==a.readyState)if(200==a.status)NodeLoader.read(a,r,n,e);else{var t=console;t.error("XHR failed: ",a.status,r),n.loaded=!1,e(n)}},a.open("GET",r,!0),a.overrideMimeType("text/plain; charset=x-user-defined"),a.responseType="arraybuffer",a.send(null)},NodeLoader.read=function(t,e,r,n){var a=console,o=!1;try{var i=t.response.byteLength,d=new DataView(t.response),g=i>=4&&87===d.getUint8(0)&&83==d.getUint8(1);g&&67==d.getUint8(2)&&2==d.getUint8(3)?NodeLoader.readLightning(d,i,r):g&&67==d.getUint8(2)&&1==d.getUint8(3)?NodeLoader.readPointPacker(d,i,r):g&&85==d.getUint8(2)&&1==d.getUint8(3)?NodeLoader.readUncompressed(d,i,r):(a.error("Unknown format:",e),o=!0)}catch(s){a.error("Unhandled:",s,s.stack,e),o=!0}r.loaded=!o,n(r)},NodeLoader.readUncompressed=function(t,e,r){for(var n=4,a=15,o=(e-n)/a,i=new Float32Array(3*o),d=new Uint8Array(4*o),g=0;o>g;g++){var s=n+g*a,v=3*g,f=4*g;i[v]=t.getFloat32(s,!1),i[v+1]=t.getFloat32(s+4,!1),i[v+2]=t.getFloat32(s+8,!1),d[f]=t.getUint8(s+12),d[f+1]=t.getUint8(s+13),d[f+2]=t.getUint8(s+14),d[f+3]=255}r.numPoints=o,r.positionArray=i,r.colorArray=d};var BitStream=function(t,e){this._dataView=t,this._byteCounter=e,this._bitCounter=7};BitStream.prototype={readPrefix:function(t,e){for(var r=this._dataView.getUint8(this._byteCounter),n=7,a=e-1,o=!1;!o;)0===(r&1<<n)?o=!0:a+8>=t?(a+=8,o=!0):a+=7,n--;return this._bitCounter=n,a},readBits:function(t){for(var e=this._dataView,r=this._byteCounter,n=this._bitCounter,a=0,o=0,i=0,d=n,g=Math.max(0,d-t+1),s=t-(d-g+1),v=Math.pow(2,s);t>o;){var f=e.getUint8(r);0===g?(r++,n=7):n=g-1,i=(1<<d+1)-1,a+=((f&i)>>g)*v,v=Math.max(1,v/256),o+=d-g+1,d=7,g=8-Math.min(8,t-o)}return this._byteCounter=r,this._bitCounter=n,a}},NodeLoader.readLightning=function(t,e,r){var n=0;n+=4;var a,o,i,d=t.getUint8(n++),g=t.getUint8(n++),s=t.getUint8(n++),v=t.getUint8(n++),f=t.getUint8(n++),l=t.getUint8(n++),U=v||f||l;l?(a=s,o=d,i=g):f?(a=g,o=d,i=s):(a=d,o=g,i=s);var u=(v?0:d)+(f?0:g)+(l?0:s),h=8-u%8,p=t.getUint8(n++),c=(t.getUint8(n++),t.getFloat32(n,!1)),y=.5*c;n+=4;var w=t.getFloat64(n,!1),C=t.getFloat64(n+8,!1),_=t.getFloat64(n+16,!1);n+=24,w+=y,C+=y,_+=y;var b=t.getUint32(n),m=t.getUint32(n+4);n+=8;for(var L=4294967296*b+m,F=0,A=new Float32Array(3*L),M=new Uint8Array(4*L),B=0,N=0,P=new BitStream(t,n),x=0;L>x;x++){var k,I,S;if(U){var V=P.readPrefix(a,h),T=P.readBits(V),q=P.readBits(o),H=P.readBits(i);T+=F,F=T,l?(S=T,k=q,I=H):f?(I=T,k=q,S=H):(k=T,I=q,S=H)}else P._bitCounter=7,k=P.readBits(d),I=P.readBits(g),S=P.readBits(s),P._bitCounter<7&&P._byteCounter++;if(A[B++]=k*c+w,A[B++]=I*c+C,A[B++]=S*c+_,2===p){var R=t.getUint8(P._byteCounter++),X=t.getUint8(P._byteCounter++);M[N++]=4+(248&R),M[N++]=2+(32*(7&R)+(224&X)/8),M[N++]=4+8*(31&X)}else for(var D=0;3>D;D++)M[N++]=t.getUint8(P._byteCounter++);M[N++]=255}r.numPoints=L,r.positionArray=A,r.colorArray=M},NodeLoader.readPointPacker=function(t,e,r){var n,a=40,o=0;o+=4;var i=[];i[0]=t.getUint8(o++),i[1]=t.getUint8(o++),i[2]=t.getUint8(o++);var d=[];for(n=0;3>n;n++)d[n]=1===i[n]?1:i[n]-1;var g=[];g[0]=t.getUint8(o++),g[1]=t.getUint8(o++),g[2]=t.getUint8(o++);var s=[];for(n=0;3>n;n++)s[n]=Math.pow(2,8*i[n]);var v=[];for(n=0;3>n;n++)v[n]=1===i[n]?Math.pow(2,8):Math.pow(2,8*(i[n]-1));var f=[];for(n=0;3>n;n++)f[n]=1===i[n]?Math.pow(2,16):s[n];var l=[];for(n=0;3>n;n++)l[n]=v[n]>>1;var U=[];for(n=0;3>n;n++)U[n]=s[n]-1;var u=[];for(n=0;3>n;n++)u[n]=v[n]-1;var h=[];for(n=0;3>n;n++){var p=(v[n]<<g[n])-1,c=i[n]>1?U[n]:Math.pow(2,16)-1;h[n]=c-p}var y=t.getUint8(o++);o++;var w=t.getInt32(o,!1);o+=4;var C=[];for(n=0;6>n;n++)C[n]=t.getFloat32(o+4*n,!1);var _=[];for(n=0;3>n;n++)_[n]=(C[n+3]-C[n])/(s[n]-Math.pow(2,g[n]));var b=new Float32Array(3*w),m=new Uint8Array(4*w),L=[];o=a;for(var F=0;w>F;F++){var A=3*F,M=4*F,B=L.length-1,N=[],P=[];for(n=0;3>n;n++){var x=0;if(L.length>1){x=t.getInt32(o-4+d[n],!1)&u[n];var k=(x&l[n])===l[n];x<<=g[n],k&&(x|=h[n]),x=(L[B].prediction[n]+x)%f[n],N[n]=x,P[n]=2*x-L[B].position[n],o+=d[n]}else 1===L.length?(x=t.getInt32(o-4+i[n],!1)&U[n],x<<=g[n],N[n]=x,P[n]=2*x-L[B].position[n],o+=i[n]):(x=t.getInt32(o-4+i[n],!1)&U[n],x<<=g[n],N[n]=x,P[n]=x,o+=i[n]);b[A+n]=C[n]+_[n]*x}var I=[];for(n=0;y>n;n++){var S=t.getUint8(o++);1<L.length&&(S=(L[B].color[n]+S)%256),I[n]=S}if(3===y)for(n=0;3>n;n++)m[M+n]=I[n];else 2===y&&(m[M]=4+(248&I[0]),m[M+1]=2+(32*(7&I[0])+(224&I[1])/8),m[M+2]=4+8*(31&I[1]));m[M+3]=255;var V=t.getUint8(o++);for(0<L.length&&L[B].numChildren--,V>0&&L.push({numChildren:V,position:N,prediction:P,color:I});0<L.length&&0===L[L.length-1].numChildren;)L.pop()}r.numPoints=w,r.positionArray=b,r.colorArray=m};