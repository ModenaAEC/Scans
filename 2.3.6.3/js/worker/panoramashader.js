PanoramaShader={},PanoramaShader.perform=function(a){var e,t=(new Date).getTime(),r=a.frameX,n=a.frameY,o=a.panoTexture0.widthPanoTexture,i=a.panoTexture0.heightPanoTexture,d=a.panoTexture0.dataPanoTexture,u=void 0!==a.panoTexture1?a.panoTexture1.dataPanoTexture:void 0,h=a.blendFactor,m=a.cameraMatrix,f=a.circleColor,T=.5*i;e="undefined"!=typeof Uint8ClampedArray?Uint8ClampedArray:"undefined"!=typeof Uint8Array?Uint8Array:Array;var p,x,M,v,P,l,y,c=void 0!==a.dataOut?a.dataOut:new e(r*n*4),A=0,w=0,U=2*Math.PI,g=.5*Math.PI,s=2/r,C=2/n,D=m[0]*s,I=m[1]*s,O=m[2]*s,S=-m[4]*C,b=-m[5]*C,q=-m[6]*C,F=m[4]-m[0]-m[8]+m[12],X=m[5]-m[1]-m[9]+m[13],Y=m[6]-m[2]-m[10]+m[14],j=-1/U*o,k=-1/g*T,z=0;for(A=0;n>=A;A+=1)for(F+=S,X+=b,Y+=q,M=F,v=X,P=Y,w=0;r>w;w+=1)if(M+=D,v+=I,P+=O,p=Math.round(Math.atan2(v,M)*j),l=Math.atan(P/Math.sqrt(M*M+v*v)),l>=-1){if(x=Math.round(l*k+T),p=p>=0?p:o+p,x=x>=0?x:i+x,p=Math.min(p,o-1),x=Math.min(x,i-1),y=4*(o*x+p),void 0!==u){var B=1-h;c[z]=d[y]*h+u[y]*B,c[z+1]=d[y+1]*h+u[y+1]*B,c[z+2]=d[y+2]*h+u[y+2]*B}else c[z]=d[y],c[z+1]=d[y+1],c[z+2]=d[y+2];c[z+3]=255,z+=4}else c[z]=f[0],c[z+1]=f[1],c[z+2]=f[2],c[z+3]=255,z+=4;var E=(new Date).getTime(),G=E-t;return{data:c,time:G}};